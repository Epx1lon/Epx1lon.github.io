---
title: FTP Server
author: epx1lon
date: 2026-01-27 00:34:00 +0800
categories: [Network, Servicios]
tags: [ftp,vsftpd]
---

El protocolo FTP es uno de los protocolos más antiguos de Internet. El FTP se ejecuta dentro de la capa de aplicación de la pila de protocolos TCP/IP. Por lo tanto, se encuentra en la misma capa que HTTP o POP. Estos protocolos también funcionan con el apoyo de navegadores o clientes de correo electrónico para prestar sus servicios. También existen programas FTP especiales para el Protocolo de Transferencia de Archivos.

En una conexión FTP, se abren <span style="color:rgb(255, 255, 0)">dos canales</span>. En primer lugar, el cliente y el servidor establecen un <span style="color:rgb(255, 255, 0)">canal de control</span> a través del <span style="color:rgb(255, 255, 0)">puerto TCP 21</span>. El cliente envía comandos al servidor y el servidor devuelve códigos de estado. Entonces ambos participantes de comunicación pueden establecer el <span style="color:rgb(255, 255, 0)">canal de datos</span> a través del <span style="color:rgb(255, 255, 0)">puerto TCP 20</span>. Este canal se utiliza exclusivamente para la transmisión de datos, y el protocolo busca errores durante este proceso. Si se rompe una conexión durante la transmisión, el transporte se puede reanudar después de restablecer el contacto.

Por lo general, necesitamos credenciales para utilizar FTP en un servidor. También debemos saber que FTP es un protocolo de texto sin cifrar que, en ocasiones, puede ser interceptado si las condiciones de la red son las adecuadas. Sin embargo, también existe la posibilidad de que un servidor ofrezca FTP anónimo. En ese caso, el operador del servidor permite a cualquier usuario cargar o descargar archivos a través de FTP sin necesidad de utilizar una contraseña. Dado que existen riesgos de seguridad asociados a este tipo de servidores FTP públicos, las opciones para los usuarios suelen ser limitadas.

## TFTP

Trivial File Transfer Protocol (TFTP) es más sencillo que el FTP y realiza transferencias de archivos entre procesos de cliente y servidor. Sin embargo, no proporciona autenticación de usuarios ni otras valiosas funciones que sí ofrece el FTP. Además, mientras que el FTP utiliza TCP, el TFTP utiliza UDP, lo que lo convierte en un protocolo poco fiable y hace que utilice la recuperación de la capa de aplicación asistida por UDP.

Veamos algunos comandos de TFTP:

| Comandos                                           | Descripción                                          |
| -------------------------------------------------- | ---------------------------------------------------- |
| <span style="color:rgb(255, 255, 0)">get</span>    | Descargar un archivo del servidor FTP al host local  |
| <span style="color:rgb(255, 255, 0)">put</span>    | Subir un archivo desde el host local al servidor FTP |
| <span style="color:rgb(255, 255, 0)">status</span> | Muestra el estado actual del servidor FTP            |
| <span style="color:rgb(255, 255, 0)">quit</span>   | Salir del servidor FTP                               |

A diferencia del cliente FTP, TFTP no tiene la función de listado de directorios.

## Configuración del servidor vsFTPd

Uno de los servidores FTP más utilizados en las distribuciones basadas en Linux es vsFTPd. La configuración predeterminada de vsFTPd se encuentra en `/etc/vsftpd.conf`, y algunos ajustes ya están predefinidos de forma predeterminada. 

Primero, instalamos el demonio desde los repositorios oficiales.

```bash
sudo apt update
sudo apt install vsftpd
```

Una vez instalado, verifica que el servicio esté corriendo: `sudo systemctl status vsftpd`.

Luego editamos el archivo de configuración `/etc/vsftpd.conf`

```bash
anonymous_enable=NO        # Desactivamos acceso anónimo por seguridad
local_enable=YES           # Permitimos que usuarios locales del sistema entren
write_enable=YES           # Permite subir archivos y crear carpetas
```
Luego habilitanmos la opcin chroot_local_user para evitar que un usuario pueda "navegar" por todo el servidor Linux, encerrándolo en su propia carpeta personal.

```bash
chroot_local_user=YES
allow_writeable_chroot=YES  
```

Creamos un usuario  dedicado exclusivamente para el servicio FTP y le damos los permisos necesarios.

```bash
sudo adduser ftpuser
sudo chown ftpuser:ftpuser /home/ftpuser
```
Por ultimo aplicamos los cambios reiniciando el servicio:

```bash
sudo systemctl restart vsftpd
```

## Configuraciones peligrosas

Uno de estos mecanismos de autenticación es el usuario <span style="color:rgb(255, 255, 0)">anonymous</span>. Esto se usa a menudo para permitir que todos en la red interna compartan archivos y datos sin acceder a las computadoras de los demás. Con vsFTPd, la siguiente [configuración opcional](http://vsftpd.beasts.org/vsftpd_conf.html) eso se puede agregar al archivo de configuración para que el inicio de sesión anónimo se vea así:


| Configuración                                                            | Descripción                                                                      |
| ------------------------------------------------------------------------ | -------------------------------------------------------------------------------- |
| <span style="color:rgb(255, 255, 0)">anonymous_enable=YES</span>         | ¿Permitir el inicio de sesión anónimo?                                           |
| <span style="color:rgb(255, 255, 0)">anon_upload_enable=YES</span>       | ¿Permitir al usuario anónimo cargar archivos?                                    |
| <span style="color:rgb(255, 255, 0)">anon_mkdir_write_enable=YES</span>  | ¿Permitir al usuario anónimo crear nuevos directorios?                           |
| <span style="color:rgb(255, 255, 0)">no_anon_password=YES</span>         | ¿No pedir la contraseña de forma anónima?               |
| <span style="color:rgb(255, 255, 0)">anon_root=/home/username/ftp</span> | Directorio para el usuario anónimo.                                              |
| <span style="color:rgb(255, 255, 0)">write_enable=YES</span>             | ¿Permitir el uso de comandos FTP: STOR, DELE, RNFR, RNTO, MKD, RMD, APPE y SITE? |


<!-- markdownlint-disable-next-line -->
> Con el cliente FTP estándar (ftp), podemos acceder al servidor FTP y obtener acceso con el usuario anónimo si se han utilizado los ajustes indicados anteriormente. El uso de la cuenta anónima puede darse en entornos e infraestructuras internos en los que se conoce a todos los participantes. El acceso a este tipo de servicio puede configurarse de forma temporal o con el ajuste para acelerar el intercambio de archivos.
{: .prompt-info }


